<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dash.entity.DashBoardMapper">
    <select id="getDataPenerimaan" parameterType="java.lang.String" resultType="java.util.Map">

        select rownum RN,a.* from(
        select a.i_rek_bank as noRekening,b.n_rek_bank as namaRekening,a.v_trx_saldoakhir as saldoAkhir from tmdashtrxhistori a, trdashbank b 
        where a.i_rek_bank=b.i_rek_bank 
        and c_kode in(1,3) and c_pengguna = 1
        and c_aktif = 1
        and C_BANK_TRANSFER = 111) a
    </select>
    <!--    <select id="getBanyakDataPenerimaan" parameterType="java.lang.String" resultType="java.lang.Integer">
        select count(*) as banyak
        select rownum RN,a.* from(
        select a.i_rek_bank as noRekening,b.n_rek_bank as namaRekening,a.v_trx_saldoakhir as saldoAkhir from tmdashtrxhistori a, trdashbank b 
        where a.i_rek_bank=b.i_rek_bank 
        and c_kode = 1 and c_pengguna = 1
        and c_aktif = 1
        and C_BANK_TRANSFER = 111) a
    </select>-->

    <select id="getDataPengeluaran" parameterType="java.lang.String" resultType="java.util.Map">
        select rownum RN,a.* from(
        select a.i_rek_bank as noRekening,b.n_rek_bank as namaRekening,a.v_trx_saldoakhir as saldoAkhir from tmdashtrxhistori a, trdashbank b 
        where a.i_rek_bank=b.i_rek_bank 
        and c_kode = 2 and c_pengguna = 1
        and c_aktif = 1
        and C_BANK_TRANSFER = 111) a
    </select>

    
    <select id='getSaldoakhir' resultType="java.util.Map">
        SELECT (SUM(SALDOAKHIRPENERIMAAN) - SUM(SALDOAKHIRPENGELUARAN)) AS SALDOAKHIR, SUM(SALDOAKHIRPENERIMAAN) as SALDOAKHIRPENERIMAAN,SUM(SALDOAKHIRPENGELUARAN) AS SALDOAKHIRPENGELUARAN
        FROM(
        SELECT SUM(a.v_trx_saldoakhir) as SALDOAKHIRPENERIMAAN,0 AS SALDOAKHIRPENGELUARAN from tmdashtrxhistori a, trdashbank b 
        where a.i_rek_bank=b.i_rek_bank 
        and c_kode in (1,3) and c_pengguna = 1
        and c_aktif = 1
        and C_BANK_TRANSFER = 111
        
        UNION ALL

        select 0 AS SALDOAKHIRPENERIMAAN,SUM(a.v_trx_saldoakhir) as SALDOAKHIRPENGELUARAN from tmdashtrxhistori a, trdashbank b 
        where a.i_rek_bank=b.i_rek_bank 
        and c_kode = 2 and c_pengguna = 1
        and c_aktif = 1
        and C_BANK_TRANSFER = 111
        )
        </select>
        <select id='getLastUpdate' resultType='java.util.Date'>
            select max(d_pgun_rekam) as lastupdate from tmdashtrxhistori
        </select>
            
</mapper>